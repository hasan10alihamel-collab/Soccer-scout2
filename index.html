<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scout AI Diagnostic</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-6">

    <div class="max-w-md mx-auto">
        <h1 class="text-3xl font-bold text-cyan-400 mb-6">SCOUT AI v3</h1>
        
        <input id="pInput" type="text" placeholder="Type: Cristiano Ronaldo" 
               class="w-full p-4 rounded-xl bg-slate-800 border border-slate-700 mb-4 text-white outline-none focus:ring-2 ring-cyan-500">
        
        <button id="searchBtn" class="w-full bg-cyan-600 p-4 rounded-xl font-black uppercase tracking-widest hover:bg-cyan-500 transition">
            Search Database
        </button>

        <div id="status" class="hidden mt-6 text-center text-cyan-400 animate-pulse font-bold">TUNNELING...</div>

        <div id="result" class="hidden mt-6 p-6 bg-slate-800 rounded-3xl border border-white/5">
            <h2 id="displayName" class="text-2xl font-black mb-4"></h2>
            <div class="flex justify-between bg-black/30 p-4 rounded-2xl">
                <div><p class="text-[10px] text-slate-500 font-bold">GOALS</p><p id="g" class="text-3xl font-black text-cyan-400"></p></div>
                <div><p class="text-[10px] text-slate-500 font-bold">MATCHES</p><p id="m" class="text-3xl font-black"></p></div>
            </div>
        </div>
    </div>

    <script>
        // DIAGNOSTIC TEST: This runs as soon as the page opens
        window.onload = () => { console.log("App Loaded Successfully"); };

        document.getElementById('searchBtn').onclick = async function() {
            const name = document.getElementById('pInput').value;
            const status = document.getElementById('status');
            const result = document.getElementById('result');

            if(!name) {
                alert("Please enter a name first!");
                return;
            }

            status.classList.remove('hidden');
            result.classList.add('hidden');

            try {
                // We use a different Wikipedia link that is more stable for mobile
                const url = `https://en.wikipedia.org/api/rest_v1/page/mobile-sections/${encodeURIComponent(name.trim().replace(/\s+/g, '_'))}`;
                
                const response = await fetch(url);
                if(!response.ok) throw new Error("Player not found. Try the exact full name.");
                
                const data = await response.json();
                
                // This part looks into the first section of the Wikipedia page
                const html = data.lead.sections[0].text;
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                let goals = "N/A";
                let apps = "N/A";

                // Scan table rows for the 'Total' career stats
                const rows = Array.from(doc.querySelectorAll('tr'));
                for (let row of rows) {
                    if (row.innerText.includes('Total')) {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 2) {
                            apps = cells[0].innerText.split('[')[0].split('(')[0].trim();
                            goals = cells[1].innerText.split('[')[0].split('(')[0].trim();
                            break; 
                        }
                    }
                }

                document.getElementById('displayName').innerText = data.lead.displaytitle;
                document.getElementById('g').innerText = goals;
                document.getElementById('m').innerText = apps;
                result.classList.remove('hidden');

            } catch (err) {
                alert("Error: " + err.message);
            } finally {
                status.classList.add('hidden');
            }
        };
    </script>
</body>
</html>
